(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{1969:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/bitpay/invoice/select",function(){return i(2802)}])},7017:function(e,n,i){"use strict";i.d(n,{I:function(){return t}});let t={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}},4669:function(e,n,i){"use strict";var t=i(5893),s=i(9845),a=i.n(s),r=i(5072),l=i(1526),c=i(7294),o=i(5356),d=i.n(o);let p=a().bind(d()),h={visible:{opacity:1,transition:{type:"tween",duration:.2,when:"beforeChildren",staggerChildren:.075}},hidden:{opacity:0}},m={visible:{opacity:1,x:0,transition:{type:"spring",damping:30,stiffness:100,mass:.25}},hidden:{opacity:0,x:12}},u={visible:{opacity:1,x:0,transition:{type:"spring",damping:30,stiffness:150,mass:.5}},hidden:{opacity:0,x:10}},b={visible:{rotate:360,transition:{loop:1/0,ease:"linear",duration:1}}};n.ZP=e=>{let{main:n,async:i}=e,[s,a]=(0,c.useState)(!1);return(0,t.jsx)(r.E.div,{onClick:()=>a(!s),className:p({button:!0,action:s}),children:(0,t.jsx)(l.M,{mode:"wait",children:s?(0,t.jsxs)(r.E.div,{style:{display:"flex"},initial:"hidden",animate:"visible",exit:"hidden",variants:h,children:[(0,t.jsx)(r.E.span,{style:{display:"flex"},variants:u,children:(0,t.jsx)(r.E.img,{className:d().action__spinner,src:"/icons/spinner.svg",variants:b,alt:"spinner"},"awaiting-payment-spinner")},"awaiting-payment-wrapper"),(0,t.jsx)(r.E.span,{variants:m,children:i},"awaiting-payment-text")]},"awaiting-payment"):(0,t.jsx)(r.E.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:h,whileTap:{scale:.98},children:n},"pay")})})}},6699:function(e,n,i){"use strict";i.d(n,{Z:function(){return x}});var t=i(5893),s=i(9845),a=i.n(s),r=i(1163),l=i(7294),c=i(7982),o=i(2609),d=i(92),p=i.n(d),h=[{path:"/0x",label:"0x",header:!0,children:[{path:"/0x",label:"Matcha",children:[{path:"/0x/matcha/onboard",label:"Onboard"},{path:"/0x/matcha/moolah",label:"Moolah"}]}]}],m=[{path:"/bitpay",label:"BitPay",header:!0,children:[{path:"/bitpay/invoice",label:"Invoice",children:[{path:"/bitpay/invoice/select",label:"Select"},{path:"/bitpay/invoice/pay",label:"Pay"},{path:"/bitpay/invoice/receipt",label:"Receipt"},{path:"/bitpay/invoice/demos",label:"Demos"}]},{path:"/bitpay/extension",label:"Extension",children:[{path:"/bitpay/extension/shop",label:"Shop"},{path:"/bitpay/extension/wallet",label:"Wallet"}]},{path:"/bitpay/id",label:"Onboard",children:[{path:"/bitpay/id/auth",label:"Auth"},{path:"/bitpay/id/verify",label:"Verify"},{path:"/bitpay/id/v2",label:"V2.0"}]},{path:"/bitpay/directory",label:"Directory"},{path:"/bitpay/emails",label:"Emails"},{path:"/bitpay/site",label:"Website"},{path:"/bitpay/support",label:"Support"}]}],u=[{path:"/portfolio",label:"Portfolio",header:!0,children:[{path:"/pob",label:"Proof of Beauty"},{path:"/0x",label:"Matcha"},{path:"/bitpay",label:"BitPay"}]}];let b=a().bind(p()),g=e=>/^https?:\/\//.test(e);var x=()=>{let e=(0,l.useContext)(c.ThemeContext),n=(0,r.useRouter)(),i=s=>{let a;return(0,t.jsxs)(t.Fragment,{children:[s.header?(0,t.jsxs)("div",{className:p().major,children:[(0,t.jsx)(o.Z,{href:"/",style:{opacity:e.dark?.4:.25},children:"Ash \xa0/\xa0\xa0"}),(0,t.jsx)(o.Z,{href:s.path,target:g(s.path)?"_blank":"",rel:"noopener noreferrer",children:s.label})]}):(0,t.jsx)(o.Z,{href:s.path,className:b({minor:!0,active:n.pathname===s.path}),target:g(s.path)?"_blank":"",rel:"noopener noreferrer",children:s.label}),s.children&&(0,t.jsx)("div",{className:p().shift,children:(a=s.children,(0,t.jsx)(t.Fragment,{children:a.map((e,n)=>(0,t.jsx)(l.Fragment,{children:i(e)},n))}))})]})};return(0,t.jsx)("nav",{className:b({nav:!0,dark:e.dark}),children:(n.pathname.includes("bitpay")?m:n.pathname.includes("0x")?h:n.pathname.includes("portfolio")?u:[]).map((e,n)=>(0,t.jsx)(l.Fragment,{children:i(e)},n))})}},8715:function(e,n,i){"use strict";var t=i(5893),s=i(7294),a=i(7982);n.Z=e=>{let{src:n}=e,i=(0,s.useRef)(null);return(0,s.useEffect)(()=>{try{var e,n;null===(n=window)||void 0===n||null===(e=n.twttr.widgets)||void 0===e||e.load(null==i?void 0:i.current)}catch(n){let e=document.createElement("script");e.setAttribute("src","https://platform.twitter.com/widgets.js"),e.setAttribute("async","true"),document.head.appendChild(e)}},[]),(0,t.jsx)(a.ThemeContext.Consumer,{children:e=>(0,t.jsx)("blockquote",{className:"twitter-tweet","data-theme":e.dark?"dark":"light",ref:i,children:(0,t.jsx)("a",{href:n})})})}},2897:function(e,n,i){"use strict";var t=i(5893),s=i(9845),a=i.n(s),r=i(8777),l=i(7294),c=i(7982),o=i(1173),d=i(2699),p=i.n(d);let h=a().bind(p()),m=r.iR;n.Z=e=>{let{src:n,carousel:i,zoom:s,maxWidth:a}=e,d=(0,l.useContext)(c.ThemeContext),u=(0,l.useRef)(null),b=(0,l.useRef)(null),{height:g}=(0,o.$l)(u),[x,y]=(0,l.useState)({width:0,height:0}),w=a?{maxWidth:a}:void 0,v=(0,l.useCallback)(()=>{if(!(null==b?void 0:b.current))return 0;let e=window.getComputedStyle(b.current).getPropertyValue("padding-top").replace("px",""),n=window.getComputedStyle(b.current).getPropertyValue("padding-bottom").replace("px","");return Number(e)+Number(n)},[b]);return(0,l.useEffect)(()=>{if(!i)return;let e=new Image;e.onload=()=>y(e),e.src=n[0]},[n]),(0,t.jsx)("div",{style:{height:g+v()},children:(0,t.jsx)("div",{className:h({wrapper:!0,wrapper__dark:d.dark}),ref:b,children:i&&n instanceof Array?(0,t.jsx)("div",{ref:u,className:p().asset,style:w,children:(0,t.jsxs)(r.sj,{naturalSlideWidth:x.width,naturalSlideHeight:x.height,totalSlides:n.length,interval:1e4,isPlaying:!0,infinite:!0,lockOnWindowScroll:!0,hasMasterSpinner:!0,children:[(0,t.jsx)(m,{onClick:e=>{var n;return null==e?void 0:null===(n=e.currentTarget)||void 0===n?void 0:n.focus()},children:n.map((e,n)=>(0,t.jsx)(r.Mi,{index:n,children:s?(0,t.jsx)(r.Ee,{src:e}):(0,t.jsx)(r.Gy,{src:e,hasMasterSpinner:!0})},n))}),(0,t.jsx)(r.I5,{className:p().dots})]})}):(0,t.jsx)(t.Fragment,{children:"string"==typeof n&&(0,t.jsx)(t.Fragment,{children:n.includes("mp4")?(0,t.jsx)("video",{ref:u,className:p().asset,style:w,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,children:(0,t.jsx)("source",{src:n,type:"video/mp4"})}):(0,t.jsx)("img",{ref:u,className:p().asset,style:w,src:n})})})})})}},2802:function(e,n,i){"use strict";i.r(n);var t=i(5893),s=i(5072);i(7294);var a=i(7017),r=i(8396),l=i(3833),c=i(5110),o=i(9602),d=i(8565),p=i(6699),h=i(9079),m=i(8715),u=i(2897);n.default=()=>(0,t.jsxs)(t.Fragment,{children:[d.Wd,(0,t.jsx)(p.Z,{}),(0,t.jsxs)(s.E.main,{className:"body",...a.I,children:[(0,t.jsxs)("section",{children:[(0,t.jsx)("h1",{className:"begin-section pt-0",children:"Wallet Selection"}),(0,t.jsx)("h5",{className:"end-section",children:"User experience tailoring and analytics"}),(0,t.jsx)(u.Z,{src:"/imgs/invoice/select/wallet-selection.png"}),(0,t.jsxs)("div",{className:"lead begin-section",children:[(0,t.jsxs)("p",{children:["Up until recently, the",(0,t.jsx)(h.Z,{content:"Invoice",href:"https://bitpay.com/demos",spaceBefore:!0,spaceAfter:!0,bold:!0}),"was a fairly robust but rigid interface. It only needed to handle 2 currencies + a Payment Protocol link or QR code. Adding ETH and ERC20 token capability became the first time we had to support another payment method (Web3) where there was clear preference based on wallet."]}),(0,t.jsx)("p",{children:"If the user is paying with a BitPay or Copay wallet, then the only way to pay is with a PayPro link. However, if the user is paying with MetaMask, then we need to connect to their wallet via Web3 to pay. Without any upfront selection, we initially handled this by detecting the presence of Web3 and providing a manual toggle (less than ideal)."}),(0,t.jsx)("blockquote",{children:"It became clear after the launch of ETH that we needed a robust but elegant way to handle rapidly diverging feature sets."}),(0,t.jsxs)("p",{children:["In response to these problems, I created the Wallet Selection flow over the course of 2019, drawing inspiration from companies like",(0,t.jsx)(h.Z,{content:"Plaid",href:"https://plaid.com/",spaceBefore:!0}),",",(0,t.jsx)(h.Z,{content:"Mollie",href:"https://www.mollie.com/",spaceBefore:!0}),", and more. I finally had a chance to build and launch it in the beginning of 2020 as the company made P2P support a major initiative."]})]}),(0,t.jsx)("video",{className:"h-align d-block end-section",width:"500",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,children:(0,t.jsx)("source",{src:"/vids/invoice/wallet-selection.mp4",type:"video/mp4"})}),(0,t.jsxs)("div",{className:"lead begin-section pt-0 end-section",children:[(0,t.jsx)("p",{children:"The solution was a relatively obvious one because of the following requirements:"}),(0,t.jsxs)("ol",{className:"list",children:[(0,t.jsxs)("li",{className:"list__item",children:[(0,t.jsx)("div",{className:"list__item__number",children:"1"}),(0,t.jsx)("div",{children:"Use Payment Protocol if supported"})]}),(0,t.jsxs)("li",{className:"list__item",children:[(0,t.jsx)("div",{className:"list__item__number",children:"2"}),(0,t.jsx)("div",{children:"Use Web3 for all other ETH wallets"})]}),(0,t.jsxs)("li",{className:"list__item",children:[(0,t.jsx)("div",{className:"list__item__number",children:"3"}),(0,t.jsx)("div",{children:"Display Address + Amount for P2P payments"})]})]}),(0,t.jsx)("p",{children:"However, because we now could now display custom behavior for any particular payment method selected, the design ended up unlocking a lot more capability than we initially set out to solve."})]}),(0,t.jsx)("h4",{className:"begin-section",children:"V4 Reference Implementation"}),(0,t.jsx)("div",{className:"begin-section wrapper-center",children:(0,t.jsx)(l.Z,{})})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"begin-section",children:"Coinbase Connect"}),(0,t.jsx)("h5",{className:"end-section",children:"Instant, zero fee payments"}),(0,t.jsx)(u.Z,{src:["/imgs/invoice/coinbase/coinbase-connect.png","/imgs/invoice/coinbase/coinbase-login.png","/imgs/invoice/coinbase/coinbase-authorize.png","/imgs/invoice/coinbase/coinbase-pay.png","/imgs/invoice/coinbase/coinbase-receipt.png"],carousel:!0}),(0,t.jsxs)("div",{className:"lead begin-section end-section",children:[(0,t.jsx)("p",{children:"As soon as we enabled P2P payments via Wallet Selection, we finally had some insight into what was really going on with users' payment experiences. Pretty quickly, Coinbase rose to our 4th most popular payment method but with a ~30% error rate."}),(0,t.jsx)("p",{children:"Basically, around 30% of Coinbase users were making some kind of error when paying due to the decoupled nature of P2P payments (push vs. pull). Common errors included mistakenly entering in a USD amount when withdrawing or a delayed transfer."}),(0,t.jsxs)("p",{children:["Coinbase's",(0,t.jsx)(h.Z,{content:"Connect API",href:"https://developers.coinbase.com/docs/wallet/coinbase-connect",spaceBefore:!0,spaceAfter:!0}),"seemed like the perfect solution to address all our problems. By directly connecting to a user's account, we can initiate an exact withdrawal while still requiring manual authorization by the user (secure & precise)."]}),(0,t.jsx)("p",{children:"The end result is an instant, errorless payment experience that bypasses the usual issues of dealing with crypto addresses and exact decimal amounts."})]}),(0,t.jsx)("h4",{children:"V4 Reference Implementation"}),(0,t.jsx)("div",{className:"begin-section end-section wrapper-center",children:(0,t.jsx)(r.Z,{type:"coinbase"})}),(0,t.jsx)("div",{className:"wrapper-center",children:(0,t.jsx)(m.Z,{src:"https://twitter.com/brian_armstrong/status/1293626788472475648"})})]}),(0,t.jsxs)("section",{className:"begin-section",children:[(0,t.jsx)("h2",{className:"begin-section",children:"Payment Tips"}),(0,t.jsx)("h5",{className:"end-section",children:"Guiding the experience with helpful info"}),(0,t.jsx)(u.Z,{src:["/imgs/invoice/select/wallet-info--cash-app.png","/imgs/invoice/select/wallet-info--bitcoin-core.png","/imgs/invoice/select/wallet-info--coinbase-wallet.png","/imgs/invoice/select/select-currency.png"],carousel:!0}),(0,t.jsxs)("div",{className:"lead begin-section end-section",children:[(0,t.jsx)("p",{children:"To handle the common pitfalls with payments, the Info state is a simple way to chuck in helpful information. Even Payment Protocol enabled wallets like Bitcoin Core / ABC are a bit tricky to use when it comes to pasting in links."}),(0,t.jsx)("p",{children:"In the case of Coinbase Wallet, the best way to ensure an accurate P2P payment experience is to scan the BIP21 URI. We often saw users manually entering into the wallet's send flow rather than scanning the QR code."})]}),(0,t.jsx)(u.Z,{src:"/imgs/invoice/select/cash-app-conversion-exception-graph.png"}),(0,t.jsxs)("div",{className:"lead begin-section end-section",children:[(0,t.jsx)("p",{children:"For other providers like Cash App, we use this state to prevent common errors we see. The graph above is demonstration of the effectiveness of this state. The inflection point around February 2020 is when we implemented an enhanced Payment Instructions state for Cash App. You can clearly see the uptrend in conversions (actually paying the Invoice) and an overall downtrend in payment errors (sending less or more money than needed)."}),(0,t.jsx)("p",{children:"Looking back on the data over the last year, it is definitely amazing what a simple change like this can do!"})]})]}),(0,t.jsxs)("section",{className:"begin-section",children:[(0,t.jsx)("h2",{className:"begin-section",children:"Feedback Loops"}),(0,t.jsx)("h5",{className:"end-section",children:"Figuring out what users want"}),(0,t.jsx)(u.Z,{src:["/imgs/invoice/select/currency-filtering.png","/imgs/invoice/select/searching.png","/imgs/invoice/select/wallet-bailout.png"],carousel:!0}),(0,t.jsxs)("div",{className:"lead begin-section end-section",children:[(0,t.jsx)("p",{children:"As I mentioned previously, a large focus of ours was making sure we were capturing as much as we could about what our users wanted. If you can't find your wallet, I included a bailout option; clicking on \"I don't see my wallet\" let's the user submit a response."}),(0,t.jsx)("p",{children:"We also keep track of what people are searching so we can preemptively investigate a payment method before a request."})]})]}),(0,t.jsxs)("section",{className:"begin-section",children:[(0,t.jsx)("h2",{className:"begin-section",children:"More Wallet Connections"}),(0,t.jsx)("h5",{className:"end-section",children:"Bringing seamless payments to others"}),(0,t.jsx)(u.Z,{src:["/imgs/invoice/select/wallet-link.png","/imgs/invoice/select/metamask-connect.png","/imgs/invoice/select/wallet-connect.png","/imgs/invoice/select/ledger-connect.png","/imgs/invoice/select/trezor-connect.png"],carousel:!0}),(0,t.jsx)("div",{className:"lead begin-section end-section",children:(0,t.jsx)("p",{children:'The screens above are a sneak peak of more direct integrations coming soon to the invoice. MetaMask is already a supported wallet but the above is an example of the in-browser "connection pending" UI.'})}),(0,t.jsx)("h4",{className:"begin-section",children:"V4 Reference Implementation"}),(0,t.jsx)("div",{className:"begin-section wrapper-center",children:(0,t.jsx)(c.Z,{type:"metamask"})}),(0,t.jsx)("div",{className:"begin-section wrapper-center",children:(0,t.jsx)(o.Z,{type:"argent"})}),(0,t.jsx)("div",{className:"begin-section wrapper-center",children:(0,t.jsx)(o.Z,{type:"coinbaseWallet"})}),(0,t.jsx)("div",{className:"begin-section wrapper-center",children:(0,t.jsx)(c.Z,{type:"ledger"})}),(0,t.jsx)("div",{className:"begin-section wrapper-center",children:(0,t.jsx)(c.Z,{type:"trezor"})})]})]})]})},2732:function(e,n,i){"use strict";i.d(n,{$W:function(){return s},Dc:function(){return t}});let t=e=>new Promise(n=>setTimeout(n,e)),s=e=>{let n=Number("0x"+e.substring(1));return"".concat(n>>16&255,", ").concat(n>>8&255,", ").concat(255&n)}},5356:function(e){e.exports={button:"button_button__Dbshu",action:"button_action__lwH8A",action__spinner:"button_action__spinner__bh814",spin:"button_spin__hbG6q"}},5206:function(e){e.exports={invoice:"invoice_invoice__Ccecj",price:"invoice_price__FSia4",title:"invoice_title__Fd2pu",caption:"invoice_caption__1uzuR"}},92:function(e){e.exports={dark:"sidebar_dark___qnvR",nav:"sidebar_nav__TIgPv",major:"sidebar_major__dRpgs",minor:"sidebar_minor__8RpND",shift:"sidebar_shift__Ok4cJ",active:"sidebar_active__WstEf"}},2699:function(e){e.exports={asset:"wide-screen_asset__M6qVo",wrapper:"wide-screen_wrapper__AeGjR",wrapper__dark:"wide-screen_wrapper__dark___w7Ye",dots:"wide-screen_dots__yu0Pw"}}},function(e){e.O(0,[72,777,171,888,774,179],function(){return e(e.s=1969)}),_N_E=e.O()}]);